{"ast":null,"code":"import _objectSpread from\"/Users/Samuel/Desktop/votely-project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{initializeApp}from'firebase/app';import{getFirestore,collection,onSnapshot,query,addDoc,doc,updateDoc,serverTimestamp,orderBy,deleteDoc,getDocs,where,setDoc,writeBatch,arrayUnion,arrayRemove,increment}from'firebase/firestore';import{getAuth,signInAnonymously,onAuthStateChanged,createUserWithEmailAndPassword,signInWithEmailAndPassword,signOut,sendEmailVerification,sendPasswordResetEmail,updateEmail,deleteUser}from'firebase/auth';// --- Hardcoded Firebase Configuration ---\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const firebaseConfig={apiKey:\"AIzaSyAwoak1xNoP4oWtLiLPJqA4-xHXTLOxZdY\",authDomain:\"votely-30af6.firebaseapp.com\",projectId:\"votely-30af6\",storageBucket:\"votely-30af6.appspot.com\",messagingSenderId:\"272205166453\",appId:\"1:272205166453:web:your-web-app-id\"};// --- ADMIN CONFIGURATION ---\nconst adminUid=\"p4HH5pPZF9YmKnE3SSOFBz1FU6c2\";// --- Pre-defined Categories ---\nconst categories=[\"Technology\",\"Home & Kitchen\",\"Books\",\"Travel\",\"Gaming\",\"Lifestyle\",\"Other\"];// --- Censored Words List ---\nconst badWords=[\"example\",\"profanity\",\"explicit\"];// Add more words here\n// --- Notification Component ---\nconst Notification=_ref=>{let{message,type,visible}=_ref;if(!visible)return null;const baseStyle=\"fixed top-5 left-1/2 -translate-x-1/2 px-6 py-3 rounded-lg shadow-lg text-white transition-all duration-300 z-50\";const typeStyle=type==='success'?'bg-green-500':'bg-red-500';return/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(baseStyle,\" \").concat(typeStyle),children:message});};// --- Confirmation Modal Component ---\nconst ConfirmationModal=_ref2=>{let{message,onConfirm,onCancel,isOpen}=_ref2;if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-xl p-6 w-full max-w-sm\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-gray-800 mb-4\",children:message}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onConfirm,className:\"bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600\",children:\"Confirm\"})]})]})});};// --- Component for Homepage List Cards ---\nconst ListCardPreview=_ref3=>{let{list,handleVote,navigateTo,user}=_ref3;const{id,title,description,items}=list;const getTotalVotes=item=>{var _item$votedBy;return(item.baseVotes||0)+(((_item$votedBy=item.votedBy)===null||_item$votedBy===void 0?void 0:_item$votedBy.length)||0);};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg overflow-hidden flex flex-col border-t-4 border-indigo-500 transform hover:-translate-y-1 transition-transform duration-300\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 flex-grow\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 font-sans\",children:title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2 h-12 overflow-hidden\",children:description}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:items.sort((a,b)=>getTotalVotes(b)-getTotalVotes(a)).slice(0,3).map((item,index)=>{var _item$votedBy2;const hasVoted=user&&((_item$votedBy2=item.votedBy)===null||_item$votedBy2===void 0?void 0:_item$votedBy2.includes(user.uid));return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-700\",children:[index+1,\". \",item.name]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-green-600\",children:getTotalVotes(item).toLocaleString()}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleVote(id,item.name),className:\"p-1 rounded-full transition-colors \".concat(hasVoted?'text-indigo-500 bg-indigo-100':'text-gray-400 hover:text-indigo-500'),children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M10.707 4.293a1 1 0 00-1.414 0l-6 6a1 1 0 001.414 1.414L10 6.414l5.293 5.293a1 1 0 001.414-1.414l-6-6z\"})}),\" \"]})]})]},index);})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-gray-50 border-t\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('list',id),className:\"text-indigo-600 hover:text-indigo-800 font-semibold text-sm\",children:\" View all \\u2192 \"})})]});};// --- Comment Component with Liking ---\nconst Comment=_ref4=>{var _comment$likedBy,_usersMap$comment$aut,_comment$createdAt,_comment$likedBy2;let{comment,user,listId,handleDeleteComment,handleModeratorDeleteComment,handleLikeComment,handlePostReply,usersMap,listAuthorId,replies}=_ref4;const[isExpanded,setIsExpanded]=useState(false);const[isReplying,setIsReplying]=useState(false);const[replyText,setReplyText]=useState('');const[showReplies,setShowReplies]=useState(false);const canBeTruncated=comment.text.length>600;const hasLiked=user&&((_comment$likedBy=comment.likedBy)===null||_comment$likedBy===void 0?void 0:_comment$likedBy.includes(user.uid));const authorUsername=((_usersMap$comment$aut=usersMap[comment.authorId])===null||_usersMap$comment$aut===void 0?void 0:_usersMap$comment$aut.username)||'Anonymous';const isAuthor=user&&user.uid===comment.authorId;const isAdmin=user&&user.uid===adminUid;const isListModerator=user&&user.uid===listAuthorId;const onDeleteClick=()=>{if(isAuthor)handleDeleteComment(listId,comment.id);else handleModeratorDeleteComment(listId,comment.id);};const onReplySubmit=e=>{e.preventDefault();if(replyText.trim()==='')return;handlePostReply(listId,comment.id,replyText);setReplyText('');setIsReplying(false);};if(comment.isDeleted){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-100 p-3 rounded-md\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 italic\",children:\"[comment deleted]\"})});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-100 p-3 rounded-md flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-800 whitespace-pre-wrap\",children:canBeTruncated&&!isExpanded?\"\".concat(comment.text.substring(0,600),\"...\"):comment.text}),canBeTruncated&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setIsExpanded(!isExpanded),className:\"text-indigo-600 hover:text-indigo-800 text-sm font-semibold mt-2\",children:[\" \",isExpanded?'Show less':'Show more',\" \"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mt-2 space-x-4\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500\",children:[\" By \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:authorUsername}),\" on \",(_comment$createdAt=comment.createdAt)!==null&&_comment$createdAt!==void 0&&_comment$createdAt.toDate?comment.createdAt.toDate().toLocaleDateString():'now',\" \"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleLikeComment(listId,comment),className:\"p-1 \".concat(hasLiked?'text-indigo-500':'text-gray-400 hover:text-indigo-500'),children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z\",clipRule:\"evenodd\"})})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-600\",children:((_comment$likedBy2=comment.likedBy)===null||_comment$likedBy2===void 0?void 0:_comment$likedBy2.length)||0})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsReplying(!isReplying),className:\"text-xs text-gray-600 font-semibold hover:text-indigo-600\",children:\"Reply\"})]})]}),(isAuthor||isAdmin||isListModerator)&&/*#__PURE__*/_jsx(\"button\",{onClick:onDeleteClick,className:\"text-gray-400 hover:text-red-500 p-1 flex-shrink-0 ml-2\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z\",clipRule:\"evenodd\"})})})]}),isReplying&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:onReplySubmit,className:\"ml-8 mt-2\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:replyText,onChange:e=>setReplyText(e.target.value),className:\"w-full p-2 border rounded-md\",rows:\"2\",placeholder:\"Write a reply...\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-2 mt-2\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setIsReplying(false),className:\"text-sm text-gray-600\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"text-sm bg-indigo-500 text-white px-3 py-1 rounded-md\",children:\"Reply\"})]})]}),(replies===null||replies===void 0?void 0:replies.length)>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"ml-8 mt-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowReplies(!showReplies),className:\"text-xs text-indigo-600 font-semibold\",children:[\" \",showReplies?'Hide replies':\"View \".concat(replies.length,\" replies\")]}),showReplies&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 space-y-2\",children:replies.map(reply=>/*#__PURE__*/_jsx(Comment,{comment:reply,user,listId,handleDeleteComment,handleModeratorDeleteComment,handleLikeComment,handlePostReply,usersMap,listAuthorId,replies:[]},reply.id))})]})]});};// --- Component for the Full List Page ---\nconst ListPage=_ref5=>{let{list,handleVote,handleAddItem,handleDeleteComment,handleModeratorDeleteComment,handleDeleteItem,handleReportList,handlePostReply,navigateTo,user,db,showNotification,usersMap,handleLikeComment,handleDeleteList}=_ref5;const{title,description,items,id,author,flaggedBy,reportedBy}=list;const[newItemName,setNewItemName]=useState('');const[comments,setComments]=useState([]);const[newComment,setNewComment]=useState('');const[visibleItems,setVisibleItems]=useState(10);const[showReportMenu,setShowReportMenu]=useState(false);const[searchResults,setSearchResults]=useState([]);const isAuthor=user&&user.uid===author;const isAdmin=user&&user.uid===adminUid;const hasReported=user&&((flaggedBy===null||flaggedBy===void 0?void 0:flaggedBy.includes(user.uid))||(reportedBy===null||reportedBy===void 0?void 0:reportedBy.includes(user.uid)));const getTotalVotes=item=>{var _item$votedBy3;return(item.baseVotes||0)+(((_item$votedBy3=item.votedBy)===null||_item$votedBy3===void 0?void 0:_item$votedBy3.length)||0);};useEffect(()=>{if(!db||!id)return;const commentsCol=collection(db,'lists',id,'comments');const q=query(commentsCol,orderBy(\"createdAt\",\"desc\"));const unsubscribe=onSnapshot(q,snapshot=>{setComments(snapshot.docs.map(doc=>_objectSpread(_objectSpread({},doc.data()),{},{id:doc.id})));});return unsubscribe;},[db,id]);const handleSearchChange=e=>{const query=e.target.value.toLowerCase();setNewItemName(e.target.value);if(query.trim()===''){setSearchResults([]);return;}const sortedItems=[...items].sort((a,b)=>getTotalVotes(b)-getTotalVotes(a));const results=sortedItems.map((item,index)=>_objectSpread(_objectSpread({},item),{},{rank:index+1})).filter(item=>item.name.toLowerCase().includes(query));setSearchResults(results.slice(0,5));};const handleItemSubmit=e=>{e.preventDefault();if(newItemName.trim()==='')return;handleAddItem(id,newItemName);setNewItemName('');setSearchResults([]);};const handleCommentSubmit=async e=>{e.preventDefault();if(newComment.trim()===''||!user||user.isAnonymous)return;if(!user.emailVerified){showNotification(\"Please verify your email to comment.\",\"error\");return;}handlePostReply(id,null,newComment);setNewComment('');};const nestedComments=comments.filter(c=>!c.parentId).map(parent=>_objectSpread(_objectSpread({},parent),{},{replies:comments.filter(reply=>reply.parentId===parent.id)}));return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-12\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('home'),className:\"mb-8 text-indigo-600 hover:text-indigo-800 font-semibold\",children:\"\\u2190 Back to Home\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800\",children:title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2 mb-8\",children:description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2 relative\",children:[(isAuthor||isAdmin)&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('edit-list',id),className:\"text-sm bg-gray-200 text-gray-700 hover:bg-gray-300 px-3 py-1 rounded-md\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteList(id),className:\"text-sm bg-red-500 text-white hover:bg-red-600 px-3 py-1 rounded-md\",children:\"Delete\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowReportMenu(!showReportMenu),disabled:hasReported,className:\"p-1 rounded-full text-gray-400 hover:text-yellow-500 disabled:opacity-50 disabled:cursor-not-allowed\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M3 6a3 3 0 013-3h10a1 1 0 01.8 1.6L14.25 8l2.55 3.4A1 1 0 0116 13H6a1 1 0 01-1-1V6z\",clipRule:\"evenodd\"})})}),showReportMenu&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute right-0 mt-8 w-48 bg-white rounded-md shadow-lg z-10\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{handleReportList(id,'duplicate');setShowReportMenu(false);},className:\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\",children:\"Flag as Duplicate\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{handleReportList(id,'inappropriate');setShowReportMenu(false);},className:\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\",children:\"Report Inappropriate\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 space-y-2\",children:items.sort((a,b)=>getTotalVotes(b)-getTotalVotes(a)).slice(0,visibleItems).map((item,index)=>{var _item$votedBy4;const hasVoted=user&&((_item$votedBy4=item.votedBy)===null||_item$votedBy4===void 0?void 0:_item$votedBy4.includes(user.uid));return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-800 font-medium\",children:[index+1,\". \",item.name]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-green-600\",children:[getTotalVotes(item).toLocaleString(),\" votes\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleVote(id,item.name),className:\"p-1 rounded-full transition-colors \".concat(hasVoted?'text-indigo-500 bg-indigo-100':'text-gray-400 hover:text-indigo-500'),children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M10.707 4.293a1 1 0 00-1.414 0l-6 6a1 1 0 001.414 1.414L10 6.414l5.293 5.293a1 1 0 001.414-1.414l-6-6z\"})})}),(isAuthor||isAdmin)&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteItem(id,item.name),className:\"text-gray-400 hover:text-red-500 p-1 rounded-full\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\",clipRule:\"evenodd\"})})})]})]},index);})}),items.length>visibleItems&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setVisibleItems(items.length),className:\"w-full mt-4 text-indigo-600 hover:text-indigo-800 font-semibold text-sm\",children:\"Show All Items\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 bg-gray-50 border-t relative\",children:[/*#__PURE__*/_jsx(\"form\",{onSubmit:handleItemSubmit,children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newItemName,onChange:handleSearchChange,placeholder:\"Vote for an existing item or add a new one...\",className:\"flex-grow px-3 py-2 text-sm rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-indigo-600 text-white px-4 py-2 text-sm font-semibold rounded-lg hover:bg-indigo-700 transition-colors shadow-sm\",children:\"Add\"})]})}),searchResults.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute left-0 right-0 mt-1 bg-white border rounded-lg shadow-lg z-10 mx-6\",children:searchResults.map(item=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{handleVote(id,item.name);setNewItemName('');setSearchResults([]);},className:\"w-full text-left px-4 py-2 hover:bg-gray-100 flex justify-between\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"#\",item.rank,\" \",item.name]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",children:[getTotalVotes(item).toLocaleString(),\" votes\"]})]},item.name))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-8 border-t\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Discussion\"}),user&&!user.isAnonymous&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCommentSubmit,className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:newComment,onChange:e=>setNewComment(e.target.value),placeholder:\"Share your thoughts...\",className:\"w-full px-3 py-2 border rounded-lg\",rows:\"3\",maxLength:\"10000\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"mt-2 bg-indigo-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm\",children:\"Post Comment\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:nestedComments.map(comment=>/*#__PURE__*/_jsx(Comment,{comment,user,listId:id,handleDeleteComment,handleModeratorDeleteComment,handleLikeComment,handlePostReply,usersMap,listAuthorId:author,replies:comment.replies},comment.id))})]})]})]});};// --- Component for Authentication Page ---\nconst AuthPage=_ref6=>{let{auth,db,navigateTo,showNotification,isSignUpMode}=_ref6;const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[username,setUsername]=useState('');const[isSignUp,setIsSignUp]=useState(isSignUpMode);const[error,setError]=useState('');useEffect(()=>{setIsSignUp(isSignUpMode);},[isSignUpMode]);const handleAuth=async e=>{e.preventDefault();setError('');try{if(isSignUp){const usersRef=collection(db,\"users\");const q=query(usersRef,where(\"username\",\"==\",username));const querySnapshot=await getDocs(q);if(!querySnapshot.empty){setError(\"Username is already taken.\");return;}const userCredential=await createUserWithEmailAndPassword(auth,email,password);const user=userCredential.user;await sendEmailVerification(user);showNotification(\"Account created! A verification link has been sent to your email.\",\"success\");await setDoc(doc(db,\"users\",user.uid),{username,lastListCreatedAt:null});}else{await signInWithEmailAndPassword(auth,email,password);}navigateTo('home');}catch(err){setError(err.message);}};return/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto px-4 py-16 flex justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full max-w-md\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-xl p-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-center text-gray-800 mb-6\",children:isSignUp?'Create an Account':'Log In'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAuth,children:[isSignUp&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"username\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",value:username,onChange:e=>setUsername(e.target.value),className:\"w-full px-3 py-2 border rounded-lg\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",value:email,onChange:e=>setEmail(e.target.value),className:\"w-full px-3 py-2 border rounded-lg\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",value:password,onChange:e=>setPassword(e.target.value),className:\"w-full px-3 py-2 border rounded-lg\",required:true})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs italic mb-4\",children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-all shadow-md\",children:isSignUp?'Sign Up':'Log In'})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-center text-gray-600 text-sm mt-6\",children:[isSignUp?'Already have an account?':\"Don't have an account?\",/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsSignUp(!isSignUp),className:\"text-indigo-600 hover:text-indigo-800 font-bold ml-1\",children:isSignUp?'Log In':'Sign Up'})]})]})})});};// --- Component for Creating/Editing a List ---\nconst ListFormPage=_ref7=>{let{handleCreateList,handleUpdateList,navigateTo,listToEdit,showNotification}=_ref7;const[title,setTitle]=useState((listToEdit===null||listToEdit===void 0?void 0:listToEdit.title)||'');const[description,setDescription]=useState((listToEdit===null||listToEdit===void 0?void 0:listToEdit.description)||'');const[category,setCategory]=useState((listToEdit===null||listToEdit===void 0?void 0:listToEdit.category)||'');const isEditing=!!listToEdit;const handleSubmit=e=>{e.preventDefault();if(!title.trim().startsWith('Best ')){showNotification(\"Title must start with 'Best ' (capital B, followed by a space).\",\"error\");return;}if(!title.trim()||!description.trim()||!category)return;if(isEditing){handleUpdateList(listToEdit.id,{title,description,category});}else{handleCreateList(title,description,category);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-12\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo(isEditing?'list':'home',isEditing?listToEdit.id:null),className:\"mb-8 text-indigo-600 hover:text-indigo-800 font-semibold\",children:\"\\u2190 Back\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full max-w-2xl mx-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-xl p-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-center text-gray-800 mb-6\",children:isEditing?'Edit List':'Create a New List'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"title\",children:\"List Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"title\",value:title,onChange:e=>setTitle(e.target.value),className:\"w-full px-3 py-2 border rounded-lg\",placeholder:\"e.g., Best Coffee Grinders\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"description\",children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"description\",value:description,onChange:e=>setDescription(e.target.value),className:\"w-full px-3 py-2 border rounded-lg\",placeholder:\"A short description of your list\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"category\",children:\"Category\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"category\",value:category,onChange:e=>setCategory(e.target.value),className:\"w-full px-3 py-2 border rounded-lg bg-white\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,children:\"Select a category\"}),categories.map(cat=>/*#__PURE__*/_jsx(\"option\",{value:cat,children:cat},cat))]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-all shadow-md\",children:isEditing?'Save Changes':'Create List'})]})]})})]});};const HowItWorksStep=_ref8=>{let{icon,title,text}=_ref8;return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4 shadow-lg\",children:icon}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-1\",children:text})]});};// --- Component for Account Management ---\nconst AccountPage=_ref9=>{let{auth,user,showNotification,navigateTo}=_ref9;const[newEmail,setNewEmail]=useState('');const[confirmDelete,setConfirmDelete]=useState('');// Handle Email Update\nconst handleUpdateEmail=async e=>{e.preventDefault();if(!newEmail||newEmail===user.email)return;try{await updateEmail(user,newEmail);showNotification(\"Email updated successfully! Please re-verify your new email.\",'success');setNewEmail('');}catch(error){showNotification(\"Error: \".concat(error.message),'error');}};// Handle Password Reset\nconst handlePasswordReset=async()=>{try{await sendPasswordResetEmail(auth,user.email);showNotification(\"A password reset link has been sent to \".concat(user.email,\".\"),'success');}catch(error){showNotification(\"Error: \".concat(error.message),'error');}};// Handle Account Deletion\nconst handleDeleteAccount=async()=>{if(confirmDelete!=='DELETE'){showNotification(\"Please type 'DELETE' to confirm.\",'error');return;}try{await deleteUser(user);showNotification(\"Account deleted successfully.\",'success');navigateTo('home');}catch(error){showNotification(\"Error: \".concat(error.message,\". You may need to log out and log back in to delete your account.\"),'error');}};if(!user)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-12 max-w-2xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800 mb-8\",children:\"Account Settings\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg p-6 mb-8\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-700 mb-4\",children:\"Update Email\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:[\"Current Email: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:user.email})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleUpdateEmail,className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:newEmail,onChange:e=>setNewEmail(e.target.value),placeholder:\"Enter new email\",className:\"flex-grow px-3 py-2 text-sm rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-indigo-600 text-white px-4 py-2 text-sm font-semibold rounded-lg hover:bg-indigo-700\",children:\"Update\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg p-6 mb-8\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-700 mb-2\",children:\"Update Password\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-4\",children:\"For security reasons, password changes are handled via email.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handlePasswordReset,className:\"bg-gray-200 text-gray-700 px-4 py-2 text-sm font-semibold rounded-lg hover:bg-gray-300\",children:\"Send Password Reset Email\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg p-6 border-2 border-red-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-red-700 mb-2\",children:\"Danger Zone\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-4\",children:\"This action is permanent and cannot be undone. All your data will be removed.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:confirmDelete,onChange:e=>setConfirmDelete(e.target.value),placeholder:\"Type 'DELETE' to confirm\",className:\"flex-grow px-3 py-2 text-sm rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDeleteAccount,className:\"bg-red-500 text-white px-4 py-2 text-sm font-semibold rounded-lg hover:bg-red-600\",children:\"Delete Account\"})]})]})]});};// --- Main App Component ---\nexport default function App(){var _usersMap$user$uid;const[lists,setLists]=useState([]);const[loading,setLoading]=useState(true);const[db,setDb]=useState(null);const[auth,setAuth]=useState(null);const[user,setUser]=useState(null);const[usersMap,setUsersMap]=useState({});const[currentPage,setCurrentPage]=useState('home');const[currentListId,setCurrentListId]=useState(null);const[authIsSignUp,setAuthIsSignUp]=useState(true);const[searchTerm,setSearchTerm]=useState('');const[selectedCategory,setSelectedCategory]=useState(null);const[notification,setNotification]=useState({message:'',type:'',visible:false});const[deleteConfirmation,setDeleteConfirmation]=useState({isOpen:false,listId:null});const[homePage,setHomePage]=useState(1);const LISTS_PER_PAGE=4;const showNotification=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'success';setNotification({message,type,visible:true});setTimeout(()=>setNotification({message:'',type:'',visible:false}),3000);};const censorText=text=>{return badWords.reduce((acc,word)=>acc.replace(new RegExp(word,'gi'),'*'.repeat(word.length)),text);};const seedDatabase=async()=>{if(!db)return;const sampleLists=[{title:\"Best Wireless Headphones\",description:\"For music lovers, commuters, and everyone in between.\",category:\"Technology\",items:[{name:\"Sony WH-1000XM5\",baseVotes:1204,votedBy:[]},{name:\"Bose QuietComfort Ultra\",baseVotes:987,votedBy:[]},{name:\"Apple AirPods Max\",baseVotes:852,votedBy:[]}],author:'system',createdAt:serverTimestamp()},{title:\"Best VPN Service\",description:\"Stay secure and private online with top-rated VPNs.\",category:\"Technology\",items:[{name:\"ExpressVPN\",baseVotes:2512,votedBy:[]},{name:\"NordVPN\",baseVotes:2109,votedBy:[]},{name:\"Surfshark\",baseVotes:1765,votedBy:[]}],author:'system',createdAt:serverTimestamp()},{title:\"Best Robot Vacuum\",description:\"Keep your floors clean with minimal effort.\",category:\"Home & Kitchen\",items:[{name:\"Roborock S8 Pro Ultra\",baseVotes:1843,votedBy:[]},{name:\"iRobot Roomba j7+\",baseVotes:1521,votedBy:[]},{name:\"Eufy Clean X8 Pro\",baseVotes:1198,votedBy:[]}],author:'system',createdAt:serverTimestamp()},{title:\"Best Science Fiction Books\",description:\"Explore new worlds and mind-bending concepts.\",category:\"Books\",items:[{name:\"Dune by Frank Herbert\",baseVotes:3102,votedBy:[]},{name:\"The Hitchhiker's Guide to the Galaxy\",baseVotes:2845,votedBy:[]},{name:\"Neuromancer by William Gibson\",baseVotes:1984,votedBy:[]}],author:'system',createdAt:serverTimestamp()},{title:\"Best European Cities for a Weekend Trip\",description:\"Incredible destinations for a short getaway.\",category:\"Travel\",items:[{name:\"Lisbon, Portugal\",baseVotes:2341,votedBy:[]},{name:\"Prague, Czech Republic\",baseVotes:2112,votedBy:[]},{name:\"Budapest, Hungary\",baseVotes:1899,votedBy:[]}],author:'system',createdAt:serverTimestamp()},{title:\"Best Board Games for Parties\",description:\"Fun and engaging games for your next get-together.\",category:\"Gaming\",items:[{name:\"Codenames\",baseVotes:4123,votedBy:[]},{name:\"Jackbox Party Pack\",baseVotes:3587,votedBy:[]},{name:\"Cards Against Humanity\",baseVotes:3101,votedBy:[]}],author:'system',createdAt:serverTimestamp()},{title:\"Best At-Home Coffee Makers\",description:\"Brew the perfect cup without leaving your house.\",category:\"Home & Kitchen\",items:[{name:\"Technivorm Moccamaster\",baseVotes:1543,votedBy:[]},{name:\"Breville Barista Express\",baseVotes:1321,votedBy:[]},{name:\"AeroPress\",baseVotes:1198,votedBy:[]}],author:'system',createdAt:serverTimestamp()},{title:\"Best Hiking Trails in North America\",description:\"Breathtaking views and unforgettable adventures.\",category:\"Travel\",items:[{name:\"Zion Narrows, Utah\",baseVotes:2890,votedBy:[]},{name:\"Grinnell Glacier, Montana\",baseVotes:2453,votedBy:[]},{name:\"West Coast Trail, British Columbia\",baseVotes:1765,votedBy:[]}],author:'system',createdAt:serverTimestamp()},{title:\"Best Productivity Apps\",description:\"Tools to help you get more done.\",category:\"Technology\",items:[{name:\"Notion\",baseVotes:3876,votedBy:[]},{name:\"Todoist\",baseVotes:3123,votedBy:[]},{name:\"Evernote\",baseVotes:2456,votedBy:[]}],author:'system',createdAt:serverTimestamp()},{title:\"Best Fantasy Book Series\",description:\"Epic sagas and magical worlds to get lost in.\",category:\"Books\",items:[{name:\"The Lord of the Rings by J.R.R. Tolkien\",baseVotes:4589,votedBy:[]},{name:\"A Song of Ice and Fire by George R.R. Martin\",baseVotes:4123,votedBy:[]},{name:\"Mistborn by Brandon Sanderson\",baseVotes:3876,votedBy:[]}],author:'system',createdAt:serverTimestamp()},{title:\"Best Wireless Gaming Mouse\",description:\"Cut the cord without sacrificing performance.\",category:\"Gaming\",items:[{name:\"Logitech G Pro X Superlight\",baseVotes:2987,votedBy:[]},{name:\"Razer Viper V2 Pro\",baseVotes:2543,votedBy:[]},{name:\"SteelSeries Aerox 5 Wireless\",baseVotes:1987,votedBy:[]}],author:'system',createdAt:serverTimestamp()},{title:\"Best Skincare Products for Beginners\",description:\"Start your skincare journey with these essentials.\",category:\"Lifestyle\",items:[{name:\"CeraVe Hydrating Cleanser\",baseVotes:3456,votedBy:[]},{name:\"The Ordinary Hyaluronic Acid\",baseVotes:2987,votedBy:[]},{name:\"La Roche-Posay Anthelios Sunscreen\",baseVotes:2345,votedBy:[]}],author:'system',createdAt:serverTimestamp()}];for(const list of sampleLists){await addDoc(collection(db,'lists'),list);}showNotification(\"Sample lists added!\",\"success\");};useEffect(()=>{const app=initializeApp(firebaseConfig);const firestoreDb=getFirestore(app);const firebaseAuth=getAuth(app);setDb(firestoreDb);setAuth(firebaseAuth);const unsubscribeAuth=onAuthStateChanged(firebaseAuth,currentUser=>{setUser(currentUser);if(!currentUser){signInAnonymously(firebaseAuth).catch(err=>console.error(\"Anonymous sign-in failed:\",err));}});const usersCol=collection(firestoreDb,'users');const unsubscribeUsers=onSnapshot(usersCol,snapshot=>{const newUsersMap={};snapshot.forEach(doc=>{newUsersMap[doc.id]=doc.data();});setUsersMap(newUsersMap);});return()=>{unsubscribeAuth();unsubscribeUsers();};},[]);useEffect(()=>{if(!user||!db){setLoading(true);return;}const listsCollection=collection(db,'lists');const q=query(listsCollection);const unsubscribeFirestore=onSnapshot(q,querySnapshot=>{const listsData=querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));if(listsData.length===0){seedDatabase();}setLists(listsData);setLoading(false);},error=>{console.error(\"Error fetching lists: \",error);setLoading(false);});return unsubscribeFirestore;},[user,db]);const navigateTo=function(page){let data=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;setCurrentPage(page);setCurrentListId(data);if(page==='auth')setAuthIsSignUp(data);};const handleLogout=async()=>{if(!auth)return;await signOut(auth);navigateTo('home');};const handleVote=async(listId,itemName)=>{var _listToUpdate$items$f,_listToUpdate$items$f2;if(!db||!user||user.isAnonymous)return showNotification(\"Please log in to vote!\",\"error\");if(!user.emailVerified)return showNotification(\"Please verify your email to vote.\",\"error\");const listDocRef=doc(db,'lists',listId);const listToUpdate=lists.find(list=>list.id===listId);if(!listToUpdate)return;const userId=user.uid;const isTogglingOff=(_listToUpdate$items$f=listToUpdate.items.find(item=>item.name===itemName))===null||_listToUpdate$items$f===void 0?void 0:(_listToUpdate$items$f2=_listToUpdate$items$f.votedBy)===null||_listToUpdate$items$f2===void 0?void 0:_listToUpdate$items$f2.includes(userId);const updatedItems=listToUpdate.items.map(item=>{const newVotedBy=(item.votedBy||[]).filter(uid=>uid!==userId);if(item.name===itemName&&!isTogglingOff){newVotedBy.push(userId);}return _objectSpread(_objectSpread({},item),{},{votedBy:newVotedBy});});await updateDoc(listDocRef,{items:updatedItems});};const handleAddItem=async(listId,newItemName)=>{if(!db||!user||user.isAnonymous)return showNotification(\"Please log in to add items!\",\"error\");if(!user.emailVerified)return showNotification(\"Please verify your email to add items.\",\"error\");const listDocRef=doc(db,'lists',listId);const listToUpdate=lists.find(list=>list.id===listId);if(!listToUpdate)return;if(listToUpdate.items.some(item=>item.name.toLowerCase()===newItemName.toLowerCase())){return showNotification(\"This item is already in the list!\",\"error\");}let wasReplaced=false;const filteredItems=listToUpdate.items.filter(item=>{if(item.addedBy===user.uid){wasReplaced=true;return false;}return true;});const newItem={name:censorText(newItemName),votedBy:[user.uid],baseVotes:0,addedBy:user.uid};const finalItems=[...filteredItems,newItem];await updateDoc(listDocRef,{items:finalItems});if(wasReplaced){showNotification(\"Your previous submission has been replaced.\",\"success\");}else{showNotification(\"Item added successfully!\",\"success\");}};const handleCreateList=async(title,description,category)=>{if(!db||!user||user.isAnonymous)return showNotification(\"Please log in to create a list!\",\"error\");if(!user.emailVerified)return showNotification(\"Please verify your email to create lists.\",\"error\");const currentUserData=usersMap[user.uid];const timeSinceLastPost=currentUserData!==null&&currentUserData!==void 0&&currentUserData.lastListCreatedAt?Date.now()-currentUserData.lastListCreatedAt.toMillis():Infinity;if(timeSinceLastPost<600000){// 10 minutes\nreturn showNotification(\"Please wait \".concat(Math.ceil((600000-timeSinceLastPost)/60000),\" minutes.\"),\"error\");}const newList={title:censorText(title),description:censorText(description),category,items:[],author:user.uid,createdAt:serverTimestamp()};try{await addDoc(collection(db,'lists'),newList);await updateDoc(doc(db,\"users\",user.uid),{lastListCreatedAt:serverTimestamp()});navigateTo('home');showNotification(\"List created successfully!\",\"success\");}catch(error){console.error(\"Error creating list: \",error);showNotification(\"Failed to create list.\",\"error\");}};const handleDeleteComment=async(listId,commentId)=>{if(!db)return;try{await deleteDoc(doc(db,'lists',listId,'comments',commentId));showNotification(\"Comment deleted.\",\"success\");}catch(error){console.error(\"Error deleting comment: \",error);showNotification(\"Failed to delete comment.\",\"error\");}};const handleLikeComment=async(listId,comment)=>{var _comment$likedBy3;if(!db||!user||user.isAnonymous)return showNotification(\"Please log in to like comments!\",\"error\");if(!user.emailVerified)return showNotification(\"Please verify your email to like comments.\",\"error\");const commentDocRef=doc(db,'lists',listId,'comments',comment.id);const hasLiked=(_comment$likedBy3=comment.likedBy)===null||_comment$likedBy3===void 0?void 0:_comment$likedBy3.includes(user.uid);try{if(hasLiked){await updateDoc(commentDocRef,{likedBy:arrayRemove(user.uid)});}else{await updateDoc(commentDocRef,{likedBy:arrayUnion(user.uid)});}}catch(error){console.error(\"Error liking comment:\",error);showNotification(\"Failed to update like.\",\"error\");}};const handleDeleteList=listId=>{setDeleteConfirmation({isOpen:true,listId});};const confirmDeleteList=async()=>{const{listId}=deleteConfirmation;if(!db||!listId)return;const listDocRef=doc(db,'lists',listId);const commentsRef=collection(db,'lists',listId,'comments');try{const batch=writeBatch(db);const commentsSnapshot=await getDocs(commentsRef);commentsSnapshot.forEach(commentDoc=>batch.delete(commentDoc.ref));batch.delete(listDocRef);await batch.commit();showNotification(\"List deleted successfully.\",\"success\");navigateTo('home');}catch(error){console.error(\"Error deleting list: \",error);showNotification(\"Failed to delete list.\",\"error\");}finally{setDeleteConfirmation({isOpen:false,listId:null});}};const handleUpdateList=async(listId,updatedData)=>{if(!db)return;const listDocRef=doc(db,'lists',listId);try{await updateDoc(listDocRef,{title:censorText(updatedData.title),description:censorText(updatedData.description),category:updatedData.category});showNotification(\"List updated successfully!\",\"success\");navigateTo('list',listId);}catch(error){console.error(\"Error updating list: \",error);showNotification(\"Failed to update list.\",\"error\");}};const handleReportList=async(listId,reportType)=>{if(!db||!user||user.isAnonymous)return showNotification(\"Please log in to flag lists.\",\"error\");if(!user.emailVerified)return showNotification(\"Please verify your email to flag content.\",\"error\");const listDocRef=doc(db,'lists',listId);const fieldToUpdate=reportType==='duplicate'?'flaggedBy':'reportedBy';try{await updateDoc(listDocRef,{[fieldToUpdate]:arrayUnion(user.uid)});showNotification(\"Report submitted. Thank you.\",\"success\");}catch(error){console.error(\"Error flagging list: \",error);showNotification(\"Failed to submit report.\",\"error\");}};const handlePostReply=async(listId,parentId,text)=>{if(!db||!user||user.isAnonymous)return showNotification(\"Please log in to comment.\",\"error\");if(!user.emailVerified)return showNotification(\"Please verify your email to comment.\",\"error\");const newCommentData={text:censorText(text),authorId:user.uid,createdAt:serverTimestamp(),likedBy:[],parentId:parentId||null,replyCount:0,isDeleted:false};try{await addDoc(collection(db,'lists',listId,'comments'),newCommentData);if(parentId){await updateDoc(doc(db,'lists',listId,'comments',parentId),{replyCount:increment(1)});}}catch(error){console.error(\"Error posting comment: \",error);showNotification(\"Failed to post comment.\",\"error\");}};const handleModeratorDeleteComment=async(listId,commentId)=>{if(!db)return;const commentDocRef=doc(db,'lists',listId,'comments',commentId);try{await updateDoc(commentDocRef,{isDeleted:true,text:\"[comment deleted]\"});showNotification(\"Comment removed.\",\"success\");}catch(error){console.error(\"Error removing comment: \",error);showNotification(\"Failed to remove comment.\",\"error\");}};const handleDeleteItem=async(listId,itemName)=>{if(!db)return;const listDocRef=doc(db,'lists',listId);const listToUpdate=lists.find(list=>list.id===listId);if(!listToUpdate)return;const updatedItems=listToUpdate.items.filter(item=>item.name!==itemName);try{await updateDoc(listDocRef,{items:updatedItems});showNotification(\"Item removed from list.\",\"success\");}catch(error){console.error(\"Error deleting item: \",error);showNotification(\"Failed to delete item.\",\"error\");}};const filteredLists=lists.filter(list=>{const searchTermLower=searchTerm.toLowerCase();return(!selectedCategory||list.category===selectedCategory)&&(list.title.toLowerCase().includes(searchTermLower)||list.description.toLowerCase().includes(searchTermLower));});const selectedList=lists.find(list=>list.id===currentListId);const renderHomePage=()=>{const getListTotalVotes=list=>list.items.reduce((sum,item)=>{var _item$votedBy5;return sum+(item.baseVotes||0)+(((_item$votedBy5=item.votedBy)===null||_item$votedBy5===void 0?void 0:_item$votedBy5.length)||0);},0);const sortedLists=[...filteredLists].sort((a,b)=>getListTotalVotes(b)-getListTotalVotes(a));const pageCount=Math.ceil(sortedLists.length/LISTS_PER_PAGE);const startIndex=(homePage-1)*LISTS_PER_PAGE;const endIndex=startIndex+LISTS_PER_PAGE;const paginatedLists=sortedLists.slice(startIndex,endIndex);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"section\",{className:\"bg-gradient-to-br from-gray-50 to-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-20 text-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl md:text-6xl font-bold text-gray-800 leading-tight\",children:\"Find the best of everything.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg md:text-xl text-gray-600 mt-4 max-w-2xl mx-auto\",children:\"Community-driven rankings you can trust.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-8\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search for anything (e.g. 'best coffee maker')\",className:\"w-full md:w-1/2 px-4 py-3 rounded-lg border-2 border-gray-200 focus:outline-none focus:border-indigo-500 transition-colors\",value:searchTerm,onChange:e=>{setSearchTerm(e.target.value);setHomePage(1);}})})]})}),/*#__PURE__*/_jsxs(\"main\",{className:\"container mx-auto px-4 py-16\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-12\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-4 text-center\",children:\"Browse by Category\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap justify-center gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectedCategory(null);setHomePage(1);},className:\"px-4 py-2 text-sm font-semibold rounded-full \".concat(!selectedCategory?'bg-indigo-500 text-white':'bg-gray-200 text-gray-700 hover:bg-gray-300'),children:\"All\"}),categories.map(cat=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectedCategory(cat);setHomePage(1);},className:\"px-4 py-2 text-sm font-semibold rounded-full \".concat(selectedCategory===cat?'bg-indigo-500 text-white':'bg-gray-200 text-gray-700 hover:bg-gray-300'),children:cat},cat))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800\",children:\"Popular Lists\"}),user&&!user.isAnonymous&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('create-list'),className:\"bg-indigo-500 text-white font-semibold px-4 py-2 rounded-lg hover:bg-indigo-600 transition-colors shadow-sm\",children:\"Create a List\"})]}),loading?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-500\",children:\"Loading...\"}):paginatedLists.length>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-8\",children:paginatedLists.map(list=>/*#__PURE__*/_jsx(ListCardPreview,{list,handleVote,navigateTo,user},list.id))}),pageCount>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center items-center mt-12 space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setHomePage(prev=>prev-1),disabled:homePage===1,className:\"px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50\",children:\"\\u2190 Previous\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-700\",children:[\"Page \",homePage,\" of \",pageCount]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setHomePage(prev=>prev+1),disabled:homePage===pageCount,className:\"px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50\",children:\"Next \\u2192\"})]})]}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-500\",children:\"No lists found. Try a different search!\"})]}),/*#__PURE__*/_jsx(\"section\",{className:\"bg-gray-50 border-t border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-20\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-center text-gray-800 mb-12\",children:\"How It Works\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-12\",children:[/*#__PURE__*/_jsx(HowItWorksStep,{icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-10 h-10 text-indigo-500\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M12 6v6m0 0v6m0-6h6m-6 0H6\"})}),title:\"Create a List\",text:\"Start a list for any category you can think of.\"}),/*#__PURE__*/_jsx(HowItWorksStep,{icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-10 h-10 text-indigo-500\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M5 15l7-7 7 7\"})}),title:\"Vote on Items\",text:\"Upvote your favorite items to help them rise to the top.\"}),/*#__PURE__*/_jsx(HowItWorksStep,{icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-10 h-10 text-indigo-500\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\"})}),title:\"Discuss\",text:\"Share your experiences and help the community decide.\"})]})]})})]});};const renderContent=()=>{if(loading&&!user){return/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-500 py-10\",children:\"Connecting...\"});}switch(currentPage){case'list':return selectedList?/*#__PURE__*/_jsx(ListPage,{list:selectedList,handleVote,handleAddItem,handleDeleteComment,handleModeratorDeleteComment,handleDeleteItem,handleLikeComment,handleReportList,handlePostReply,handleDeleteList,navigateTo,user,db,showNotification,usersMap}):renderHomePage();case'auth':return/*#__PURE__*/_jsx(AuthPage,{auth,db,navigateTo,showNotification,isSignUpMode:authIsSignUp});case'create-list':return/*#__PURE__*/_jsx(ListFormPage,{handleCreateList,navigateTo,showNotification});case'edit-list':return/*#__PURE__*/_jsx(ListFormPage,{handleUpdateList,navigateTo,listToEdit:selectedList,showNotification});case'account':return/*#__PURE__*/_jsx(AccountPage,{auth,user,showNotification,navigateTo});default:return renderHomePage();}};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-100 font-sans\",children:[/*#__PURE__*/_jsxs(\"style\",{children:[\" \",\"@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap'); .font-sans { font-family: 'Poppins', sans-serif; }\",\" \"]}),/*#__PURE__*/_jsx(Notification,_objectSpread({},notification)),/*#__PURE__*/_jsx(ConfirmationModal,{isOpen:deleteConfirmation.isOpen,message:\"Are you sure you want to permanently delete this list and all its comments?\",onConfirm:confirmDeleteList,onCancel:()=>setDeleteConfirmation({isOpen:false,listId:null})}),/*#__PURE__*/_jsx(\"header\",{className:\"bg-white shadow-sm sticky top-0 z-10\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center py-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-indigo-600 cursor-pointer\",onClick:()=>navigateTo('home'),children:\"Votely\"}),/*#__PURE__*/_jsx(\"div\",{className:\"hidden md:flex items-center space-x-6\",children:user&&!user.isAnonymous?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('account'),className:\"text-gray-600 text-sm font-semibold hover:text-indigo-600\",children:((_usersMap$user$uid=usersMap[user.uid])===null||_usersMap$user$uid===void 0?void 0:_usersMap$user$uid.username)||user.email}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"text-gray-600 hover:text-indigo-600\",children:\"Logout\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('auth',false),className:\"text-gray-600 hover:text-indigo-600\",children:\"Login\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('auth',true),className:\"bg-indigo-500 text-white px-4 py-2 rounded-lg hover:bg-indigo-600 shadow-sm transition-all\",children:\"Sign Up\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"md:hidden\",children:/*#__PURE__*/_jsx(\"button\",{className:\"text-gray-600 hover:text-gray-900\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M4 6h16M4 12h16m-7 6h7\"})})})})]})})}),renderContent(),/*#__PURE__*/_jsx(\"footer\",{className:\"bg-white\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-6 text-center text-gray-600\",children:[\"\\xA9 \",new Date().getFullYear(),\" Votely. All rights reserved.\"]})})]});}","map":{"version":3,"names":["React","useState","useEffect","initializeApp","getFirestore","collection","onSnapshot","query","addDoc","doc","updateDoc","serverTimestamp","orderBy","deleteDoc","getDocs","where","setDoc","writeBatch","arrayUnion","arrayRemove","increment","getAuth","signInAnonymously","onAuthStateChanged","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","sendEmailVerification","sendPasswordResetEmail","updateEmail","deleteUser","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","adminUid","categories","badWords","Notification","_ref","message","type","visible","baseStyle","typeStyle","className","concat","children","ConfirmationModal","_ref2","onConfirm","onCancel","isOpen","onClick","ListCardPreview","_ref3","list","handleVote","navigateTo","user","id","title","description","items","getTotalVotes","item","_item$votedBy","baseVotes","votedBy","length","sort","a","b","slice","map","index","_item$votedBy2","hasVoted","includes","uid","name","toLocaleString","fill","viewBox","d","Comment","_ref4","_comment$likedBy","_usersMap$comment$aut","_comment$createdAt","_comment$likedBy2","comment","listId","handleDeleteComment","handleModeratorDeleteComment","handleLikeComment","handlePostReply","usersMap","listAuthorId","replies","isExpanded","setIsExpanded","isReplying","setIsReplying","replyText","setReplyText","showReplies","setShowReplies","canBeTruncated","text","hasLiked","likedBy","authorUsername","authorId","username","isAuthor","isAdmin","isListModerator","onDeleteClick","onReplySubmit","e","preventDefault","trim","isDeleted","substring","createdAt","toDate","toLocaleDateString","fillRule","clipRule","onSubmit","value","onChange","target","rows","placeholder","reply","ListPage","_ref5","handleAddItem","handleDeleteItem","handleReportList","db","showNotification","handleDeleteList","author","flaggedBy","reportedBy","newItemName","setNewItemName","comments","setComments","newComment","setNewComment","visibleItems","setVisibleItems","showReportMenu","setShowReportMenu","searchResults","setSearchResults","hasReported","_item$votedBy3","commentsCol","q","unsubscribe","snapshot","docs","_objectSpread","data","handleSearchChange","toLowerCase","sortedItems","results","rank","filter","handleItemSubmit","handleCommentSubmit","isAnonymous","emailVerified","nestedComments","c","parentId","parent","disabled","_item$votedBy4","maxLength","AuthPage","_ref6","auth","isSignUpMode","email","setEmail","password","setPassword","setUsername","isSignUp","setIsSignUp","error","setError","handleAuth","usersRef","querySnapshot","empty","userCredential","lastListCreatedAt","err","htmlFor","required","ListFormPage","_ref7","handleCreateList","handleUpdateList","listToEdit","setTitle","setDescription","category","setCategory","isEditing","handleSubmit","startsWith","cat","HowItWorksStep","_ref8","icon","AccountPage","_ref9","newEmail","setNewEmail","confirmDelete","setConfirmDelete","handleUpdateEmail","handlePasswordReset","handleDeleteAccount","App","_usersMap$user$uid","lists","setLists","loading","setLoading","setDb","setAuth","setUser","setUsersMap","currentPage","setCurrentPage","currentListId","setCurrentListId","authIsSignUp","setAuthIsSignUp","searchTerm","setSearchTerm","selectedCategory","setSelectedCategory","notification","setNotification","deleteConfirmation","setDeleteConfirmation","homePage","setHomePage","LISTS_PER_PAGE","arguments","undefined","setTimeout","censorText","reduce","acc","word","replace","RegExp","repeat","seedDatabase","sampleLists","app","firestoreDb","firebaseAuth","unsubscribeAuth","currentUser","catch","console","usersCol","unsubscribeUsers","newUsersMap","forEach","listsCollection","unsubscribeFirestore","listsData","page","handleLogout","itemName","_listToUpdate$items$f","_listToUpdate$items$f2","listDocRef","listToUpdate","find","userId","isTogglingOff","updatedItems","newVotedBy","push","some","wasReplaced","filteredItems","addedBy","newItem","finalItems","currentUserData","timeSinceLastPost","Date","now","toMillis","Infinity","Math","ceil","newList","commentId","_comment$likedBy3","commentDocRef","confirmDeleteList","commentsRef","batch","commentsSnapshot","commentDoc","delete","ref","commit","updatedData","reportType","fieldToUpdate","newCommentData","replyCount","filteredLists","searchTermLower","selectedList","renderHomePage","getListTotalVotes","sum","_item$votedBy5","sortedLists","pageCount","startIndex","endIndex","paginatedLists","prev","stroke","strokeLinecap","strokeLinejoin","strokeWidth","renderContent","getFullYear"],"sources":["/Users/Samuel/Desktop/votely-project/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { initializeApp } from 'firebase/app';\nimport { getFirestore, collection, onSnapshot, query, addDoc, doc, updateDoc, serverTimestamp, orderBy, deleteDoc, getDocs, where, setDoc, writeBatch, arrayUnion, arrayRemove, increment } from 'firebase/firestore';\nimport { getAuth, signInAnonymously, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, sendEmailVerification, sendPasswordResetEmail, updateEmail, deleteUser } from 'firebase/auth';\n\n// --- Hardcoded Firebase Configuration ---\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAwoak1xNoP4oWtLiLPJqA4-xHXTLOxZdY\",\n  authDomain: \"votely-30af6.firebaseapp.com\",\n  projectId: \"votely-30af6\",\n  storageBucket: \"votely-30af6.appspot.com\",\n  messagingSenderId: \"272205166453\",\n  appId: \"1:272205166453:web:your-web-app-id\"\n};\n\n// --- ADMIN CONFIGURATION ---\nconst adminUid = \"p4HH5pPZF9YmKnE3SSOFBz1FU6c2\";\n\n// --- Pre-defined Categories ---\nconst categories = [\"Technology\", \"Home & Kitchen\", \"Books\", \"Travel\", \"Gaming\", \"Lifestyle\", \"Other\"];\n\n// --- Censored Words List ---\nconst badWords = [\"example\", \"profanity\", \"explicit\"]; // Add more words here\n\n\n// --- Notification Component ---\nconst Notification = ({ message, type, visible }) => {\n    if (!visible) return null;\n    const baseStyle = \"fixed top-5 left-1/2 -translate-x-1/2 px-6 py-3 rounded-lg shadow-lg text-white transition-all duration-300 z-50\";\n    const typeStyle = type === 'success' ? 'bg-green-500' : 'bg-red-500';\n    return <div className={`${baseStyle} ${typeStyle}`}>{message}</div>;\n};\n\n// --- Confirmation Modal Component ---\nconst ConfirmationModal = ({ message, onConfirm, onCancel, isOpen }) => {\n    if (!isOpen) return null;\n\n    return (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n            <div className=\"bg-white rounded-lg shadow-xl p-6 w-full max-w-sm\">\n                <p className=\"text-lg text-gray-800 mb-4\">{message}</p>\n                <div className=\"flex justify-end space-x-2\">\n                    <button onClick={onCancel} className=\"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300\">Cancel</button>\n                    <button onClick={onConfirm} className=\"bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600\">Confirm</button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\n\n// --- Component for Homepage List Cards ---\nconst ListCardPreview = ({ list, handleVote, navigateTo, user }) => {\n    const { id, title, description, items } = list;\n    const getTotalVotes = (item) => (item.baseVotes || 0) + (item.votedBy?.length || 0);\n\n    return (\n        <div className=\"bg-white rounded-lg shadow-lg overflow-hidden flex flex-col border-t-4 border-indigo-500 transform hover:-translate-y-1 transition-transform duration-300\">\n            <div className=\"p-6 flex-grow\">\n                <h3 className=\"text-xl font-bold text-gray-800 font-sans\">{title}</h3>\n                <p className=\"text-gray-600 mt-2 h-12 overflow-hidden\">{description}</p>\n                <div className=\"mt-4\">\n                    {items.sort((a, b) => getTotalVotes(b) - getTotalVotes(a)).slice(0, 3).map((item, index) => {\n                        const hasVoted = user && item.votedBy?.includes(user.uid);\n                        return (\n                            <div key={index} className=\"flex items-center justify-between mb-2\">\n                                <span className=\"text-gray-700\">{index + 1}. {item.name}</span>\n                                <div className=\"flex items-center space-x-2\">\n                                    <span className=\"font-bold text-green-600\">{(getTotalVotes(item)).toLocaleString()}</span>\n                                    <button onClick={() => handleVote(id, item.name)} className={`p-1 rounded-full transition-colors ${hasVoted ? 'text-indigo-500 bg-indigo-100' : 'text-gray-400 hover:text-indigo-500'}`}><svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M10.707 4.293a1 1 0 00-1.414 0l-6 6a1 1 0 001.414 1.414L10 6.414l5.293 5.293a1 1 0 001.414-1.414l-6-6z\"></path></svg> </button>\n                                </div>\n                            </div>\n                        );\n                    })}\n                </div>\n            </div>\n            <div className=\"p-4 bg-gray-50 border-t\">\n                 <button onClick={() => navigateTo('list', id)} className=\"text-indigo-600 hover:text-indigo-800 font-semibold text-sm\"> View all &rarr; </button>\n            </div>\n        </div>\n    );\n};\n\n// --- Comment Component with Liking ---\nconst Comment = ({ comment, user, listId, handleDeleteComment, handleModeratorDeleteComment, handleLikeComment, handlePostReply, usersMap, listAuthorId, replies }) => {\n    const [isExpanded, setIsExpanded] = useState(false);\n    const [isReplying, setIsReplying] = useState(false);\n    const [replyText, setReplyText] = useState('');\n    const [showReplies, setShowReplies] = useState(false);\n    const canBeTruncated = comment.text.length > 600;\n    const hasLiked = user && comment.likedBy?.includes(user.uid);\n    const authorUsername = usersMap[comment.authorId]?.username || 'Anonymous';\n    const isAuthor = user && user.uid === comment.authorId;\n    const isAdmin = user && user.uid === adminUid;\n    const isListModerator = user && user.uid === listAuthorId;\n\n    const onDeleteClick = () => {\n        if (isAuthor) handleDeleteComment(listId, comment.id);\n        else handleModeratorDeleteComment(listId, comment.id);\n    };\n\n    const onReplySubmit = (e) => {\n        e.preventDefault();\n        if(replyText.trim() === '') return;\n        handlePostReply(listId, comment.id, replyText);\n        setReplyText('');\n        setIsReplying(false);\n    };\n\n    if (comment.isDeleted) {\n        return <div className=\"bg-gray-100 p-3 rounded-md\"><p className=\"text-gray-500 italic\">[comment deleted]</p></div>;\n    }\n\n    return (\n        <div>\n            <div className=\"bg-gray-100 p-3 rounded-md flex justify-between items-start\">\n                <div>\n                    <p className=\"text-gray-800 whitespace-pre-wrap\">\n                        {canBeTruncated && !isExpanded ? `${comment.text.substring(0, 600)}...` : comment.text}\n                    </p>\n                    {canBeTruncated && (\n                        <button onClick={() => setIsExpanded(!isExpanded)} className=\"text-indigo-600 hover:text-indigo-800 text-sm font-semibold mt-2\"> {isExpanded ? 'Show less' : 'Show more'} </button>\n                    )}\n                    <div className=\"flex items-center mt-2 space-x-4\">\n                        <p className=\"text-xs text-gray-500\"> By <span className=\"font-semibold\">{authorUsername}</span> on {comment.createdAt?.toDate ? comment.createdAt.toDate().toLocaleDateString() : 'now'} </p>\n                        <div className=\"flex items-center\">\n                            <button onClick={() => handleLikeComment(listId, comment)} className={`p-1 ${hasLiked ? 'text-indigo-500' : 'text-gray-400 hover:text-indigo-500'}`}>\n                                <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fillRule=\"evenodd\" d=\"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z\" clipRule=\"evenodd\"></path></svg>\n                            </button>\n                            <span className=\"text-xs text-gray-600\">{(comment.likedBy?.length || 0)}</span>\n                        </div>\n                        <button onClick={() => setIsReplying(!isReplying)} className=\"text-xs text-gray-600 font-semibold hover:text-indigo-600\">Reply</button>\n                    </div>\n                </div>\n                {(isAuthor || isAdmin || isListModerator) && (\n                    <button onClick={onDeleteClick} className=\"text-gray-400 hover:text-red-500 p-1 flex-shrink-0 ml-2\">\n                        <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fillRule=\"evenodd\"d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z\" clipRule=\"evenodd\"></path></svg>\n                    </button>\n                )}\n            </div>\n            {isReplying && (\n                <form onSubmit={onReplySubmit} className=\"ml-8 mt-2\">\n                    <textarea value={replyText} onChange={e => setReplyText(e.target.value)} className=\"w-full p-2 border rounded-md\" rows=\"2\" placeholder=\"Write a reply...\"></textarea>\n                    <div className=\"flex justify-end space-x-2 mt-2\">\n                        <button type=\"button\"onClick={() => setIsReplying(false)} className=\"text-sm text-gray-600\">Cancel</button>\n                        <button type=\"submit\"className=\"text-sm bg-indigo-500 text-white px-3 py-1 rounded-md\">Reply</button>\n                    </div>\n                </form>\n            )}\n            {replies?.length > 0 && (\n                <div className=\"ml-8 mt-2\">\n                    <button onClick={() => setShowReplies(!showReplies)} className=\"text-xs text-indigo-600 font-semibold\"> {showReplies ? 'Hide replies' : `View ${replies.length} replies`}</button>\n                    {showReplies && (\n                        <div className=\"mt-2 space-y-2\">\n                            {replies.map(reply => <Comment key={reply.id} {...{ comment: reply, user, listId, handleDeleteComment, handleModeratorDeleteComment, handleLikeComment, handlePostReply, usersMap, listAuthorId, replies: [] }} />)}\n                        </div>\n                    )}\n                </div>\n            )}\n        </div>\n    );\n};\n\n// --- Component for the Full List Page ---\nconst ListPage = ({ list, handleVote, handleAddItem, handleDeleteComment, handleModeratorDeleteComment, handleDeleteItem, handleReportList, handlePostReply, navigateTo, user, db, showNotification, usersMap, handleLikeComment, handleDeleteList }) => {\n    const { title, description, items, id, author, flaggedBy, reportedBy } = list;\n    const [newItemName, setNewItemName] = useState('');\n    const [comments, setComments] = useState([]);\n    const [newComment, setNewComment] = useState('');\n    const [visibleItems, setVisibleItems] = useState(10);\n    const [showReportMenu, setShowReportMenu] = useState(false);\n    const [searchResults, setSearchResults] = useState([]);\n    const isAuthor = user && user.uid === author;\n    const isAdmin = user && user.uid === adminUid;\n    const hasReported = user && (flaggedBy?.includes(user.uid) || reportedBy?.includes(user.uid));\n    const getTotalVotes = (item) => (item.baseVotes || 0) + (item.votedBy?.length || 0);\n\n    useEffect(() => {\n        if (!db || !id) return;\n        const commentsCol = collection(db, 'lists', id, 'comments');\n        const q = query(commentsCol, orderBy(\"createdAt\", \"desc\"));\n        const unsubscribe = onSnapshot(q, (snapshot) => {\n            setComments(snapshot.docs.map(doc => ({ ...doc.data(), id: doc.id })));\n        });\n        return unsubscribe;\n    }, [db, id]);\n\n    const handleSearchChange = (e) => {\n        const query = e.target.value.toLowerCase();\n        setNewItemName(e.target.value);\n        if (query.trim() === '') {\n            setSearchResults([]);\n            return;\n        }\n        const sortedItems = [...items].sort((a, b) => getTotalVotes(b) - getTotalVotes(a));\n        const results = sortedItems\n            .map((item, index) => ({ ...item, rank: index + 1 }))\n            .filter(item => item.name.toLowerCase().includes(query));\n        setSearchResults(results.slice(0, 5));\n    };\n\n    const handleItemSubmit = (e) => {\n        e.preventDefault();\n        if (newItemName.trim() === '') return;\n        handleAddItem(id, newItemName);\n        setNewItemName('');\n        setSearchResults([]);\n    };\n\n    const handleCommentSubmit = async (e) => {\n        e.preventDefault();\n        if (newComment.trim() === '' || !user || user.isAnonymous) return;\n        if (!user.emailVerified) {\n            showNotification(\"Please verify your email to comment.\", \"error\");\n            return;\n        }\n        handlePostReply(id, null, newComment);\n        setNewComment('');\n    };\n\n    const nestedComments = comments.filter(c => !c.parentId).map(parent => ({ ...parent, replies: comments.filter(reply => reply.parentId === parent.id) }));\n\n    return (\n        <div className=\"container mx-auto px-4 py-12\">\n            <button onClick={() => navigateTo('home')} className=\"mb-8 text-indigo-600 hover:text-indigo-800 font-semibold\">&larr; Back to Home</button>\n            <div className=\"bg-white rounded-lg shadow-lg overflow-hidden\">\n                <div className=\"p-8\">\n                    <div className=\"flex justify-between items-start\">\n                        <div>\n                            <h2 className=\"text-3xl font-bold text-gray-800\">{title}</h2>\n                            <p className=\"text-gray-600 mt-2 mb-8\">{description}</p>\n                        </div>\n                        <div className=\"flex space-x-2 relative\">\n                           {(isAuthor || isAdmin) && (\n                                <>\n                                    <button onClick={() => navigateTo('edit-list', id)} className=\"text-sm bg-gray-200 text-gray-700 hover:bg-gray-300 px-3 py-1 rounded-md\">Edit</button>\n                                    <button onClick={() => handleDeleteList(id)} className=\"text-sm bg-red-500 text-white hover:bg-red-600 px-3 py-1 rounded-md\">Delete</button>\n                                </>\n                           )}\n                           <button onClick={() => setShowReportMenu(!showReportMenu)} disabled={hasReported} className=\"p-1 rounded-full text-gray-400 hover:text-yellow-500 disabled:opacity-50 disabled:cursor-not-allowed\"><svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fillRule=\"evenodd\" d=\"M3 6a3 3 0 013-3h10a1 1 0 01.8 1.6L14.25 8l2.55 3.4A1 1 0 0116 13H6a1 1 0 01-1-1V6z\" clipRule=\"evenodd\"></path></svg></button>\n                           {showReportMenu && (\n                               <div className=\"absolute right-0 mt-8 w-48 bg-white rounded-md shadow-lg z-10\">\n                                   <button onClick={() => { handleReportList(id, 'duplicate'); setShowReportMenu(false); }} className=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\">Flag as Duplicate</button>\n                                   <button onClick={() => { handleReportList(id, 'inappropriate'); setShowReportMenu(false); }} className=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\">Report Inappropriate</button>\n                               </div>\n                           )}\n                        </div>\n                    </div>\n                    <div className=\"mt-4 space-y-2\">\n                        {items.sort((a, b) => getTotalVotes(b) - getTotalVotes(a)).slice(0, visibleItems).map((item, index) => {\n                            const hasVoted = user && item.votedBy?.includes(user.uid);\n                            return (\n                                <div key={index} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                                    <span className=\"text-gray-800 font-medium\">{index + 1}. {item.name}</span>\n                                    <div className=\"flex items-center space-x-3\">\n                                        <span className=\"font-bold text-green-600\">{getTotalVotes(item).toLocaleString()} votes</span>\n                                        <button onClick={() => handleVote(id, item.name)} className={`p-1 rounded-full transition-colors ${hasVoted ? 'text-indigo-500 bg-indigo-100' : 'text-gray-400 hover:text-indigo-500'}`}>\n                                            <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M10.707 4.293a1 1 0 00-1.414 0l-6 6a1 1 0 001.414 1.414L10 6.414l5.293 5.293a1 1 0 001.414-1.414l-6-6z\"></path></svg>\n                                        </button>\n                                        {(isAuthor || isAdmin) && (\n                                            <button onClick={() => handleDeleteItem(id, item.name)} className=\"text-gray-400 hover:text-red-500 p-1 rounded-full\">\n                                                <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fillRule=\"evenodd\"d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\"></path></svg>\n                                            </button>\n                                        )}\n                                    </div>\n                                </div>\n                            );\n                        })}\n                    </div>\n                    {items.length > visibleItems && (\n                        <button onClick={() => setVisibleItems(items.length)} className=\"w-full mt-4 text-indigo-600 hover:text-indigo-800 font-semibold text-sm\">Show All Items</button>\n                    )}\n                </div>\n                <div className=\"p-6 bg-gray-50 border-t relative\">\n                     <form onSubmit={handleItemSubmit}>\n                        <div className=\"flex space-x-2\">\n                            <input type=\"text\" value={newItemName} onChange={handleSearchChange} placeholder=\"Vote for an existing item or add a new one...\" className=\"flex-grow px-3 py-2 text-sm rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500\" />\n                            <button type=\"submit\" className=\"bg-indigo-600 text-white px-4 py-2 text-sm font-semibold rounded-lg hover:bg-indigo-700 transition-colors shadow-sm\">Add</button>\n                        </div>\n                     </form>\n                     {searchResults.length > 0 && (\n                        <div className=\"absolute left-0 right-0 mt-1 bg-white border rounded-lg shadow-lg z-10 mx-6\">\n                            {searchResults.map(item => (\n                                <button key={item.name} onClick={() => { handleVote(id, item.name); setNewItemName(''); setSearchResults([]); }} className=\"w-full text-left px-4 py-2 hover:bg-gray-100 flex justify-between\">\n                                    <span>#{item.rank} {item.name}</span>\n                                    <span className=\"text-gray-500\">{getTotalVotes(item).toLocaleString()} votes</span>\n                                </button>\n                            ))}\n                        </div>\n                     )}\n                </div>\n                <div className=\"p-8 border-t\">\n                    <h3 className=\"text-xl font-bold text-gray-800 mb-4\">Discussion</h3>\n                    {user && !user.isAnonymous && (\n                        <form onSubmit={handleCommentSubmit} className=\"mb-6\">\n                            <textarea value={newComment} onChange={e => setNewComment(e.target.value)} placeholder=\"Share your thoughts...\" className=\"w-full px-3 py-2 border rounded-lg\" rows=\"3\" maxLength=\"10000\"></textarea>\n                            <button type=\"submit\" className=\"mt-2 bg-indigo-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors shadow-sm\">Post Comment</button>\n                        </form>\n                    )}\n                    <div className=\"space-y-4\">\n                        {nestedComments.map(comment => (\n                           <Comment key={comment.id} {...{ comment, user, listId: id, handleDeleteComment, handleModeratorDeleteComment, handleLikeComment, handlePostReply, usersMap, listAuthorId: author, replies: comment.replies }} />\n                        ))}\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\n// --- Component for Authentication Page ---\nconst AuthPage = ({ auth, db, navigateTo, showNotification, isSignUpMode }) => {\n    const [email, setEmail] = useState('');\n    const [password, setPassword] = useState('');\n    const [username, setUsername] = useState('');\n    const [isSignUp, setIsSignUp] = useState(isSignUpMode);\n    const [error, setError] = useState('');\n\n    useEffect(() => {\n        setIsSignUp(isSignUpMode);\n    }, [isSignUpMode]);\n\n    const handleAuth = async (e) => {\n        e.preventDefault();\n        setError('');\n        try {\n            if (isSignUp) {\n                const usersRef = collection(db, \"users\");\n                const q = query(usersRef, where(\"username\", \"==\", username));\n                const querySnapshot = await getDocs(q);\n                if (!querySnapshot.empty) {\n                    setError(\"Username is already taken.\");\n                    return;\n                }\n\n                const userCredential = await createUserWithEmailAndPassword(auth, email, password);\n                const user = userCredential.user;\n\n                await sendEmailVerification(user);\n                showNotification(\"Account created! A verification link has been sent to your email.\", \"success\");\n\n                await setDoc(doc(db, \"users\", user.uid), { username, lastListCreatedAt: null });\n            } else {\n                await signInWithEmailAndPassword(auth, email, password);\n            }\n            navigateTo('home');\n        } catch (err) {\n            setError(err.message);\n        }\n    };\n\n    return (\n        <div className=\"container mx-auto px-4 py-16 flex justify-center\">\n            <div className=\"w-full max-w-md\">\n                <div className=\"bg-white rounded-lg shadow-xl p-8\">\n                    <h2 className=\"text-2xl font-bold text-center text-gray-800 mb-6\">{isSignUp ? 'Create an Account' : 'Log In'}</h2>\n                    <form onSubmit={handleAuth}>\n                        {isSignUp && (\n                            <div className=\"mb-4\">\n                                <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"username\">Username</label>\n                                <input type=\"text\" id=\"username\" value={username} onChange={e => setUsername(e.target.value)} className=\"w-full px-3 py-2 border rounded-lg\" required />\n                            </div>\n                        )}\n                        <div className=\"mb-4\">\n                            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"email\">Email</label>\n                            <input type=\"email\" id=\"email\" value={email} onChange={e => setEmail(e.target.value)} className=\"w-full px-3 py-2 border rounded-lg\" required />\n                        </div>\n                        <div className=\"mb-6\">\n                            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"password\">Password</label>\n                            <input type=\"password\" id=\"password\" value={password} onChange={e => setPassword(e.target.value)} className=\"w-full px-3 py-2 border rounded-lg\" required />\n                        </div>\n                        {error && <p className=\"text-red-500 text-xs italic mb-4\">{error}</p>}\n                        <button type=\"submit\" className=\"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-all shadow-md\">\n                            {isSignUp ? 'Sign Up' : 'Log In'}\n                        </button>\n                    </form>\n                    <p className=\"text-center text-gray-600 text-sm mt-6\">\n                        {isSignUp ? 'Already have an account?' : \"Don't have an account?\"}\n                        <button onClick={() => setIsSignUp(!isSignUp)} className=\"text-indigo-600 hover:text-indigo-800 font-bold ml-1\">\n                            {isSignUp ? 'Log In' : 'Sign Up'}\n                        </button>\n                    </p>\n                </div>\n            </div>\n        </div>\n    );\n};\n\n// --- Component for Creating/Editing a List ---\nconst ListFormPage = ({ handleCreateList, handleUpdateList, navigateTo, listToEdit, showNotification }) => {\n    const [title, setTitle] = useState(listToEdit?.title || '');\n    const [description, setDescription] = useState(listToEdit?.description || '');\n    const [category, setCategory] = useState(listToEdit?.category || '');\n    const isEditing = !!listToEdit;\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        if (!title.trim().startsWith('Best ')) {\n            showNotification(\"Title must start with 'Best ' (capital B, followed by a space).\", \"error\");\n            return;\n        }\n        if (!title.trim() || !description.trim() || !category) return;\n        if (isEditing) {\n            handleUpdateList(listToEdit.id, { title, description, category });\n        } else {\n            handleCreateList(title, description, category);\n        }\n    };\n\n    return (\n        <div className=\"container mx-auto px-4 py-12\">\n            <button onClick={() => navigateTo(isEditing ? 'list' : 'home', isEditing ? listToEdit.id : null)} className=\"mb-8 text-indigo-600 hover:text-indigo-800 font-semibold\">&larr; Back</button>\n            <div className=\"w-full max-w-2xl mx-auto\">\n                <div className=\"bg-white rounded-lg shadow-xl p-8\">\n                    <h2 className=\"text-2xl font-bold text-center text-gray-800 mb-6\">{isEditing ? 'Edit List' : 'Create a New List'}</h2>\n                    <form onSubmit={handleSubmit}>\n                        <div className=\"mb-4\">\n                            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"title\">List Title</label>\n                            <input type=\"text\" id=\"title\" value={title} onChange={e => setTitle(e.target.value)} className=\"w-full px-3 py-2 border rounded-lg\" placeholder=\"e.g., Best Coffee Grinders\" required />\n                        </div>\n                        <div className=\"mb-6\">\n                            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"description\">Description</label>\n                            <textarea id=\"description\" value={description} onChange={e => setDescription(e.target.value)} className=\"w-full px-3 py-2 border rounded-lg\" placeholder=\"A short description of your list\" required />\n                        </div>\n                        <div className=\"mb-6\">\n                            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"category\">Category</label>\n                            <select id=\"category\" value={category} onChange={e => setCategory(e.target.value)} className=\"w-full px-3 py-2 border rounded-lg bg-white\" required>\n                                <option value=\"\" disabled>Select a category</option>\n                                {categories.map(cat => <option key={cat} value={cat}>{cat}</option>)}\n                            </select>\n                        </div>\n                        <button type=\"submit\" className=\"w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-all shadow-md\">\n                            {isEditing ? 'Save Changes' : 'Create List'}\n                        </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nconst HowItWorksStep = ({ icon, title, text }) => (\n     <div className=\"text-center\">\n        <div className=\"bg-white rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4 shadow-lg\">{icon}</div>\n        <h3 className=\"text-lg font-semibold text-gray-800\">{title}</h3>\n        <p className=\"text-gray-600 mt-1\">{text}</p>\n    </div>\n);\n\n// --- Component for Account Management ---\nconst AccountPage = ({ auth, user, showNotification, navigateTo }) => {\n    const [newEmail, setNewEmail] = useState('');\n    const [confirmDelete, setConfirmDelete] = useState('');\n\n    // Handle Email Update\n    const handleUpdateEmail = async (e) => {\n        e.preventDefault();\n        if (!newEmail || newEmail === user.email) return;\n        try {\n            await updateEmail(user, newEmail);\n            showNotification(\"Email updated successfully! Please re-verify your new email.\", 'success');\n            setNewEmail('');\n        } catch (error) {\n            showNotification(`Error: ${error.message}`, 'error');\n        }\n    };\n\n    // Handle Password Reset\n    const handlePasswordReset = async () => {\n        try {\n            await sendPasswordResetEmail(auth, user.email);\n            showNotification(`A password reset link has been sent to ${user.email}.`, 'success');\n        } catch (error) {\n            showNotification(`Error: ${error.message}`, 'error');\n        }\n    };\n\n    // Handle Account Deletion\n    const handleDeleteAccount = async () => {\n        if (confirmDelete !== 'DELETE') {\n            showNotification(\"Please type 'DELETE' to confirm.\", 'error');\n            return;\n        }\n        try {\n            await deleteUser(user);\n            showNotification(\"Account deleted successfully.\", 'success');\n            navigateTo('home');\n        } catch (error) {\n            showNotification(`Error: ${error.message}. You may need to log out and log back in to delete your account.`, 'error');\n        }\n    };\n\n    if (!user) return null;\n\n    return (\n        <div className=\"container mx-auto px-4 py-12 max-w-2xl\">\n            <h2 className=\"text-3xl font-bold text-gray-800 mb-8\">Account Settings</h2>\n            \n            {/* --- Update Email --- */}\n            <div className=\"bg-white rounded-lg shadow-lg p-6 mb-8\">\n                <h3 className=\"text-xl font-semibold text-gray-700 mb-4\">Update Email</h3>\n                <p className=\"text-sm text-gray-600 mb-2\">Current Email: <span className=\"font-medium\">{user.email}</span></p>\n                <form onSubmit={handleUpdateEmail} className=\"flex space-x-2\">\n                    <input \n                        type=\"email\" \n                        value={newEmail} \n                        onChange={(e) => setNewEmail(e.target.value)}\n                        placeholder=\"Enter new email\" \n                        className=\"flex-grow px-3 py-2 text-sm rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n                    />\n                    <button type=\"submit\" className=\"bg-indigo-600 text-white px-4 py-2 text-sm font-semibold rounded-lg hover:bg-indigo-700\">Update</button>\n                </form>\n            </div>\n\n            {/* --- Update Password --- */}\n            <div className=\"bg-white rounded-lg shadow-lg p-6 mb-8\">\n                <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">Update Password</h3>\n                <p className=\"text-sm text-gray-600 mb-4\">For security reasons, password changes are handled via email.</p>\n                <button onClick={handlePasswordReset} className=\"bg-gray-200 text-gray-700 px-4 py-2 text-sm font-semibold rounded-lg hover:bg-gray-300\">Send Password Reset Email</button>\n            </div>\n\n            {/* --- Delete Account --- */}\n            <div className=\"bg-white rounded-lg shadow-lg p-6 border-2 border-red-200\">\n                <h3 className=\"text-xl font-semibold text-red-700 mb-2\">Danger Zone</h3>\n                <p className=\"text-sm text-gray-600 mb-4\">This action is permanent and cannot be undone. All your data will be removed.</p>\n                <div className=\"flex items-center space-x-2\">\n                    <input \n                        type=\"text\" \n                        value={confirmDelete}\n                        onChange={(e) => setConfirmDelete(e.target.value)}\n                        placeholder=\"Type 'DELETE' to confirm\"\n                        className=\"flex-grow px-3 py-2 text-sm rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500\"\n                    />\n                    <button onClick={handleDeleteAccount} className=\"bg-red-500 text-white px-4 py-2 text-sm font-semibold rounded-lg hover:bg-red-600\">Delete Account</button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\n\n// --- Main App Component ---\nexport default function App() {\n    const [lists, setLists] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [db, setDb] = useState(null);\n    const [auth, setAuth] = useState(null);\n    const [user, setUser] = useState(null);\n    const [usersMap, setUsersMap] = useState({});\n    const [currentPage, setCurrentPage] = useState('home');\n    const [currentListId, setCurrentListId] = useState(null);\n    const [authIsSignUp, setAuthIsSignUp] = useState(true);\n    const [searchTerm, setSearchTerm] = useState('');\n    const [selectedCategory, setSelectedCategory] = useState(null);\n    const [notification, setNotification] = useState({ message: '', type: '', visible: false });\n    const [deleteConfirmation, setDeleteConfirmation] = useState({ isOpen: false, listId: null });\n    const [homePage, setHomePage] = useState(1); \n    const LISTS_PER_PAGE = 4;\n\n    const showNotification = (message, type = 'success') => {\n        setNotification({ message, type, visible: true });\n        setTimeout(() => setNotification({ message: '', type: '', visible: false }), 3000);\n    };\n\n    const censorText = (text) => {\n        return badWords.reduce((acc, word) => acc.replace(new RegExp(word, 'gi'), '*'.repeat(word.length)), text);\n    };\n\n    const seedDatabase = async () => {\n        if (!db) return;\n        const sampleLists = [\n            { title: \"Best Wireless Headphones\", description: \"For music lovers, commuters, and everyone in between.\", category: \"Technology\", items: [ { name: \"Sony WH-1000XM5\", baseVotes: 1204, votedBy: [] }, { name: \"Bose QuietComfort Ultra\", baseVotes: 987, votedBy: [] }, { name: \"Apple AirPods Max\", baseVotes: 852, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n            { title: \"Best VPN Service\", description: \"Stay secure and private online with top-rated VPNs.\", category: \"Technology\", items: [ { name: \"ExpressVPN\", baseVotes: 2512, votedBy: [] }, { name: \"NordVPN\", baseVotes: 2109, votedBy: [] }, { name: \"Surfshark\", baseVotes: 1765, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n            { title: \"Best Robot Vacuum\", description: \"Keep your floors clean with minimal effort.\", category: \"Home & Kitchen\", items: [ { name: \"Roborock S8 Pro Ultra\", baseVotes: 1843, votedBy: [] }, { name: \"iRobot Roomba j7+\", baseVotes: 1521, votedBy: [] }, { name: \"Eufy Clean X8 Pro\", baseVotes: 1198, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n            { title: \"Best Science Fiction Books\", description: \"Explore new worlds and mind-bending concepts.\", category: \"Books\", items: [ { name: \"Dune by Frank Herbert\", baseVotes: 3102, votedBy: [] }, { name: \"The Hitchhiker's Guide to the Galaxy\", baseVotes: 2845, votedBy: [] }, { name: \"Neuromancer by William Gibson\", baseVotes: 1984, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n            { title: \"Best European Cities for a Weekend Trip\", description: \"Incredible destinations for a short getaway.\", category: \"Travel\", items: [ { name: \"Lisbon, Portugal\", baseVotes: 2341, votedBy: [] }, { name: \"Prague, Czech Republic\", baseVotes: 2112, votedBy: [] }, { name: \"Budapest, Hungary\", baseVotes: 1899, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n            { title: \"Best Board Games for Parties\", description: \"Fun and engaging games for your next get-together.\", category: \"Gaming\", items: [ { name: \"Codenames\", baseVotes: 4123, votedBy: [] }, { name: \"Jackbox Party Pack\", baseVotes: 3587, votedBy: [] }, { name: \"Cards Against Humanity\", baseVotes: 3101, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n            { title: \"Best At-Home Coffee Makers\", description: \"Brew the perfect cup without leaving your house.\", category: \"Home & Kitchen\", items: [ { name: \"Technivorm Moccamaster\", baseVotes: 1543, votedBy: [] }, { name: \"Breville Barista Express\", baseVotes: 1321, votedBy: [] }, { name: \"AeroPress\", baseVotes: 1198, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n            { title: \"Best Hiking Trails in North America\", description: \"Breathtaking views and unforgettable adventures.\", category: \"Travel\", items: [ { name: \"Zion Narrows, Utah\", baseVotes: 2890, votedBy: [] }, { name: \"Grinnell Glacier, Montana\", baseVotes: 2453, votedBy: [] }, { name: \"West Coast Trail, British Columbia\", baseVotes: 1765, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n            { title: \"Best Productivity Apps\", description: \"Tools to help you get more done.\", category: \"Technology\", items: [ { name: \"Notion\", baseVotes: 3876, votedBy: [] }, { name: \"Todoist\", baseVotes: 3123, votedBy: [] }, { name: \"Evernote\", baseVotes: 2456, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n            { title: \"Best Fantasy Book Series\", description: \"Epic sagas and magical worlds to get lost in.\", category: \"Books\", items: [ { name: \"The Lord of the Rings by J.R.R. Tolkien\", baseVotes: 4589, votedBy: [] }, { name: \"A Song of Ice and Fire by George R.R. Martin\", baseVotes: 4123, votedBy: [] }, { name: \"Mistborn by Brandon Sanderson\", baseVotes: 3876, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n            { title: \"Best Wireless Gaming Mouse\", description: \"Cut the cord without sacrificing performance.\", category: \"Gaming\", items: [ { name: \"Logitech G Pro X Superlight\", baseVotes: 2987, votedBy: [] }, { name: \"Razer Viper V2 Pro\", baseVotes: 2543, votedBy: [] }, { name: \"SteelSeries Aerox 5 Wireless\", baseVotes: 1987, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n            { title: \"Best Skincare Products for Beginners\", description: \"Start your skincare journey with these essentials.\", category: \"Lifestyle\", items: [ { name: \"CeraVe Hydrating Cleanser\", baseVotes: 3456, votedBy: [] }, { name: \"The Ordinary Hyaluronic Acid\", baseVotes: 2987, votedBy: [] }, { name: \"La Roche-Posay Anthelios Sunscreen\", baseVotes: 2345, votedBy: [] } ], author: 'system', createdAt: serverTimestamp() },\n        ];\n\n        for (const list of sampleLists) {\n            await addDoc(collection(db, 'lists'), list);\n        }\n        showNotification(\"Sample lists added!\", \"success\");\n    };\n\n    useEffect(() => {\n        const app = initializeApp(firebaseConfig);\n        const firestoreDb = getFirestore(app);\n        const firebaseAuth = getAuth(app);\n        setDb(firestoreDb);\n        setAuth(firebaseAuth);\n\n        const unsubscribeAuth = onAuthStateChanged(firebaseAuth, (currentUser) =>{\n            setUser(currentUser);\n            if (!currentUser) {\n                signInAnonymously(firebaseAuth).catch(err => console.error(\"Anonymous sign-in failed:\", err));\n            }\n        });\n\n        const usersCol = collection(firestoreDb, 'users');\n        const unsubscribeUsers = onSnapshot(usersCol, (snapshot) => {\n            const newUsersMap = {};\n            snapshot.forEach(doc => {\n                newUsersMap[doc.id] = doc.data();\n            });\n            setUsersMap(newUsersMap);\n        });\n\n        return () => {\n            unsubscribeAuth();\n            unsubscribeUsers();\n        };\n    }, []);\n\n    useEffect(() => {\n        if (!user || !db) {\n            setLoading(true);\n            return;\n        }\n        const listsCollection = collection(db, 'lists');\n        const q = query(listsCollection);\n        const unsubscribeFirestore = onSnapshot(q, (querySnapshot) => {\n            const listsData = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n            if(listsData.length === 0) {\n                seedDatabase();\n            }\n            setLists(listsData);\n            setLoading(false);\n        }, (error) => {\n            console.error(\"Error fetching lists: \", error);\n            setLoading(false);\n        });\n        return unsubscribeFirestore;\n    }, [user, db]);\n\n    const navigateTo = (page, data = null) => {\n        setCurrentPage(page);\n        setCurrentListId(data);\n        if (page === 'auth') setAuthIsSignUp(data);\n    };\n\n    const handleLogout = async () => {\n        if (!auth) return;\n        await signOut(auth);\n        navigateTo('home');\n    };\n\n    const handleVote = async (listId, itemName) => {\n        if (!db || !user || user.isAnonymous) return showNotification(\"Please log in to vote!\", \"error\");\n        if (!user.emailVerified) return showNotification(\"Please verify your email to vote.\", \"error\");\n    \n        const listDocRef = doc(db, 'lists', listId);\n        const listToUpdate = lists.find(list => list.id === listId);\n        if (!listToUpdate) return;\n    \n        const userId = user.uid;\n    \n        const isTogglingOff = listToUpdate.items.find(item => item.name === itemName)?.votedBy?.includes(userId);\n    \n        const updatedItems = listToUpdate.items.map(item => {\n            const newVotedBy = (item.votedBy || []).filter(uid => uid !== userId);\n    \n            if (item.name === itemName && !isTogglingOff) {\n                newVotedBy.push(userId);\n            }\n    \n            return { ...item, votedBy: newVotedBy };\n        });\n    \n        await updateDoc(listDocRef, { items: updatedItems });\n    };\n\n    const handleAddItem = async (listId, newItemName) => {\n        if (!db || !user || user.isAnonymous) return showNotification(\"Please log in to add items!\", \"error\");\n        if (!user.emailVerified) return showNotification(\"Please verify your email to add items.\", \"error\");\n    \n        const listDocRef = doc(db, 'lists', listId);\n        const listToUpdate = lists.find(list => list.id === listId);\n        if (!listToUpdate) return;\n    \n        if (listToUpdate.items.some(item => item.name.toLowerCase() === newItemName.toLowerCase())) {\n            return showNotification(\"This item is already in the list!\", \"error\");\n        }\n    \n        let wasReplaced = false;\n        const filteredItems = listToUpdate.items.filter(item => {\n            if (item.addedBy === user.uid) {\n                wasReplaced = true;\n                return false;\n            }\n            return true;\n        });\n    \n        const newItem = {\n            name: censorText(newItemName),\n            votedBy: [user.uid],\n            baseVotes: 0,\n            addedBy: user.uid\n        };\n    \n        const finalItems = [...filteredItems, newItem];\n    \n        await updateDoc(listDocRef, { items: finalItems });\n    \n        if (wasReplaced) {\n            showNotification(\"Your previous submission has been replaced.\", \"success\");\n        } else {\n            showNotification(\"Item added successfully!\", \"success\");\n        }\n    };\n\n    const handleCreateList = async (title, description, category) => {\n        if (!db || !user || user.isAnonymous) return showNotification(\"Please log in to create a list!\", \"error\");\n        if (!user.emailVerified) return showNotification(\"Please verify your email to create lists.\", \"error\");\n        const currentUserData = usersMap[user.uid];\n        const timeSinceLastPost = currentUserData?.lastListCreatedAt ? Date.now() - currentUserData.lastListCreatedAt.toMillis() : Infinity;\n        if (timeSinceLastPost < 600000) { // 10 minutes\n            return showNotification(`Please wait ${Math.ceil((600000 - timeSinceLastPost) / 60000)} minutes.`, \"error\");\n        }\n        const newList = { title: censorText(title), description: censorText(description), category, items: [], author: user.uid, createdAt: serverTimestamp() };\n        try {\n            await addDoc(collection(db, 'lists'), newList);\n            await updateDoc(doc(db, \"users\", user.uid), { lastListCreatedAt: serverTimestamp() });\n            navigateTo('home');\n            showNotification(\"List created successfully!\", \"success\");\n        } catch (error) {\n            console.error(\"Error creating list: \", error);\n            showNotification(\"Failed to create list.\", \"error\");\n        }\n    };\n\n    const handleDeleteComment = async (listId, commentId) => {\n        if (!db) return;\n        try {\n            await deleteDoc(doc(db, 'lists', listId, 'comments', commentId));\n            showNotification(\"Comment deleted.\", \"success\");\n        } catch (error) {\n            console.error(\"Error deleting comment: \", error);\n            showNotification(\"Failed to delete comment.\", \"error\");\n        }\n    };\n\n    const handleLikeComment = async (listId, comment) => {\n        if (!db || !user || user.isAnonymous) return showNotification(\"Please log in to like comments!\", \"error\");\n        if (!user.emailVerified) return showNotification(\"Please verify your email to like comments.\", \"error\");\n        const commentDocRef = doc(db, 'lists', listId, 'comments', comment.id);\n        const hasLiked = comment.likedBy?.includes(user.uid);\n        try {\n            if (hasLiked) {\n                await updateDoc(commentDocRef, { likedBy: arrayRemove(user.uid) });\n            } else {\n                await updateDoc(commentDocRef, { likedBy: arrayUnion(user.uid) });\n            }\n        } catch(error) {\n            console.error(\"Error liking comment:\", error);\n            showNotification(\"Failed to update like.\", \"error\");\n        }\n    };\n\n    const handleDeleteList = (listId) => {\n        setDeleteConfirmation({ isOpen: true, listId });\n    };\n\n    const confirmDeleteList = async () => {\n        const { listId } = deleteConfirmation;\n        if (!db || !listId) return;\n        const listDocRef = doc(db, 'lists', listId);\n        const commentsRef = collection(db, 'lists', listId, 'comments');\n        try {\n            const batch = writeBatch(db);\n            const commentsSnapshot = await getDocs(commentsRef);\n            commentsSnapshot.forEach(commentDoc => batch.delete(commentDoc.ref));\n            batch.delete(listDocRef);\n            await batch.commit();\n            showNotification(\"List deleted successfully.\", \"success\");\n            navigateTo('home');\n        } catch (error) {\n            console.error(\"Error deleting list: \", error);\n            showNotification(\"Failed to delete list.\", \"error\");\n        } finally {\n            setDeleteConfirmation({ isOpen: false, listId: null });\n        }\n    };\n\n    const handleUpdateList = async (listId, updatedData) => {\n        if (!db) return;\n        const listDocRef = doc(db, 'lists', listId);\n        try {\n            await updateDoc(listDocRef, { title: censorText(updatedData.title), description: censorText(updatedData.description), category: updatedData.category });\n            showNotification(\"List updated successfully!\", \"success\");\n            navigateTo('list', listId);\n        } catch (error) {\n            console.error(\"Error updating list: \", error);\n            showNotification(\"Failed to update list.\", \"error\");\n        }\n    };\n\n    const handleReportList = async (listId, reportType) => {\n        if (!db || !user || user.isAnonymous) return showNotification(\"Please log in to flag lists.\", \"error\");\n        if(!user.emailVerified) return showNotification(\"Please verify your email to flag content.\", \"error\");\n        const listDocRef = doc(db, 'lists', listId);\n        const fieldToUpdate = reportType === 'duplicate' ? 'flaggedBy' : 'reportedBy';\n        try {\n            await updateDoc(listDocRef, { [fieldToUpdate]: arrayUnion(user.uid) });\n            showNotification(\"Report submitted. Thank you.\", \"success\");\n        } catch (error) {\n            console.error(\"Error flagging list: \", error);\n            showNotification(\"Failed to submit report.\", \"error\");\n        }\n    };\n\n    const handlePostReply = async (listId, parentId, text) => {\n        if (!db || !user || user.isAnonymous) return showNotification(\"Please log in to comment.\", \"error\");\n        if (!user.emailVerified) return showNotification(\"Please verify your email to comment.\", \"error\");\n        const newCommentData = { text: censorText(text), authorId: user.uid, createdAt: serverTimestamp(), likedBy: [], parentId: parentId || null, replyCount: 0, isDeleted: false, };\n        try {\n            await addDoc(collection(db, 'lists', listId, 'comments'), newCommentData);\n            if (parentId) {\n                await updateDoc(doc(db, 'lists', listId, 'comments', parentId), { replyCount: increment(1) });\n            }\n        } catch (error) {\n            console.error(\"Error posting comment: \", error);\n            showNotification(\"Failed to post comment.\", \"error\");\n        }\n    };\n\n    const handleModeratorDeleteComment = async (listId, commentId) => {\n        if (!db) return;\n        const commentDocRef = doc(db, 'lists', listId, 'comments', commentId);\n        try {\n            await updateDoc(commentDocRef, { isDeleted: true, text: \"[comment deleted]\" });\n            showNotification(\"Comment removed.\", \"success\");\n        } catch (error) {\n            console.error(\"Error removing comment: \", error);\n            showNotification(\"Failed to remove comment.\", \"error\");\n        }\n    };\n\n    const handleDeleteItem = async (listId, itemName) => {\n        if (!db) return;\n        const listDocRef = doc(db, 'lists', listId);\n        const listToUpdate = lists.find(list => list.id === listId);\n        if (!listToUpdate) return;\n        const updatedItems = listToUpdate.items.filter(item => item.name !== itemName);\n        try {\n            await updateDoc(listDocRef, { items: updatedItems });\n            showNotification(\"Item removed from list.\", \"success\");\n        } catch (error) {\n            console.error(\"Error deleting item: \", error);\n            showNotification(\"Failed to delete item.\", \"error\");\n        }\n    };\n\n    const filteredLists = lists.filter(list => {\n        const searchTermLower = searchTerm.toLowerCase();\n        return (!selectedCategory || list.category === selectedCategory) && (list.title.toLowerCase().includes(searchTermLower) || list.description.toLowerCase().includes(searchTermLower));\n    });\n\n    const selectedList = lists.find(list => list.id === currentListId);\n\n    const renderHomePage = () => {\n        const getListTotalVotes = (list) => list.items.reduce((sum, item) => sum + (item.baseVotes || 0) + (item.votedBy?.length || 0), 0);\n        const sortedLists = [...filteredLists].sort((a, b) => getListTotalVotes(b) - getListTotalVotes(a));\n        const pageCount = Math.ceil(sortedLists.length / LISTS_PER_PAGE);\n        const startIndex = (homePage - 1) * LISTS_PER_PAGE;\n        const endIndex = startIndex + LISTS_PER_PAGE;\n        const paginatedLists = sortedLists.slice(startIndex, endIndex);\n\n        return (\n            <>\n                <section className=\"bg-gradient-to-br from-gray-50 to-gray-100\">\n                    <div className=\"container mx-auto px-4 py-20 text-center\">\n                        <h1 className=\"text-4xl md:text-6xl font-bold text-gray-800 leading-tight\">Find the best of everything.</h1>\n                        <p className=\"text-lg md:text-xl text-gray-600 mt-4 max-w-2xl mx-auto\">Community-driven rankings you can trust.</p>\n                        <div className=\"mt-8\">\n                            <input type=\"text\" placeholder=\"Search for anything (e.g. 'best coffee maker')\" className=\"w-full md:w-1/2 px-4 py-3 rounded-lg border-2 border-gray-200 focus:outline-none focus:border-indigo-500 transition-colors\" value={searchTerm} onChange={(e) => { setSearchTerm(e.target.value); setHomePage(1); }} />\n                        </div>\n                    </div>\n                </section>\n                <main className=\"container mx-auto px-4 py-16\">\n                    <div className=\"mb-12\">\n                        <h3 className=\"text-xl font-bold text-gray-800 mb-4 text-center\">Browse by Category</h3>\n                        <div className=\"flex flex-wrap justify-center gap-2\">\n                            <button onClick={() => { setSelectedCategory(null); setHomePage(1); }} className={`px-4 py-2 text-sm font-semibold rounded-full ${!selectedCategory ? 'bg-indigo-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}>All</button>\n                            {categories.map(cat => (\n                                <button key={cat} onClick={() => { setSelectedCategory(cat); setHomePage(1); }} className={`px-4 py-2 text-sm font-semibold rounded-full ${selectedCategory === cat ? 'bg-indigo-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}>{cat}</button>\n                            ))}\n                        </div>\n                    </div>\n                    <div className=\"flex justify-between items-center mb-8\">\n                        <h2 className=\"text-3xl font-bold text-gray-800\">Popular Lists</h2>\n                        {user && !user.isAnonymous && (\n                            <button onClick={() => navigateTo('create-list')} className=\"bg-indigo-500 text-white font-semibold px-4 py-2 rounded-lg hover:bg-indigo-600 transition-colors shadow-sm\">Create a List</button>\n                        )}\n                    </div>\n                    {loading ? <p className=\"text-center text-gray-500\">Loading...</p> : paginatedLists.length > 0 ? (\n                        <>\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n                                {paginatedLists.map(list => <ListCardPreview key={list.id} {...{ list, handleVote, navigateTo, user }} />)}\n                            </div>\n                            {pageCount > 1 && (\n                                <div className=\"flex justify-center items-center mt-12 space-x-4\">\n                                    <button onClick={() => setHomePage(prev => prev - 1)} disabled={homePage === 1} className=\"px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50\">&larr; Previous</button>\n                                    <span className=\"text-sm text-gray-700\">Page {homePage} of {pageCount}</span>\n                                    <button onClick={() => setHomePage(prev => prev + 1)} disabled={homePage === pageCount} className=\"px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50\">Next &rarr;</button>\n                                </div>\n                            )}\n                        </>\n                    ) : (<p className=\"text-center text-gray-500\">No lists found. Try a different search!</p>)}\n                </main>\n                <section className=\"bg-gray-50 border-t border-b border-gray-200\">\n                    <div className=\"container mx-auto px-4 py-20\">\n                        <h2 className=\"text-3xl font-bold text-center text-gray-800 mb-12\">How It Works</h2>\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-12\">\n                            <HowItWorksStep icon={<svg className=\"w-10 h-10 text-indigo-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\"></path></svg>} title=\"Create a List\" text=\"Start a list for any category you can think of.\" />\n                            <HowItWorksStep icon={<svg className=\"w-10 h-10 text-indigo-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M5 15l7-7 7 7\"></path></svg>} title=\"Vote on Items\" text=\"Upvote your favorite items to help them rise to the top.\" />\n                            <HowItWorksStep icon={<svg className=\"w-10 h-10 text-indigo-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\"strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\"></path></svg>} title=\"Discuss\" text=\"Share your experiences and help the community decide.\" />\n                        </div>\n                    </div>\n                </section>\n            </>\n        );\n    };\n\n    const renderContent = () => {\n        if (loading && !user) {\n            return <p className=\"text-center text-gray-500 py-10\">Connecting...</p>;\n        }\n        switch (currentPage) {\n            case 'list':\n                return selectedList ? <ListPage {...{ list: selectedList, handleVote, handleAddItem, handleDeleteComment, handleModeratorDeleteComment, handleDeleteItem, handleLikeComment, handleReportList, handlePostReply, handleDeleteList, navigateTo, user, db, showNotification, usersMap }} /> : renderHomePage();\n            case 'auth':\n                return <AuthPage {...{ auth, db, navigateTo, showNotification, isSignUpMode: authIsSignUp }} />;\n            case 'create-list':\n                return <ListFormPage {...{ handleCreateList, navigateTo, showNotification }} />;\n            case 'edit-list':\n                return <ListFormPage {...{ handleUpdateList, navigateTo, listToEdit: selectedList, showNotification }} />;\n            case 'account':\n                return <AccountPage {...{ auth, user, showNotification, navigateTo }} />;\n            default:\n                return renderHomePage();\n        }\n    };\n\n    return (\n        <div className=\"bg-gray-100 font-sans\">\n            <style> {`@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap'); .font-sans { font-family: 'Poppins', sans-serif; }`} </style>\n            <Notification {...notification} />\n            <ConfirmationModal isOpen={deleteConfirmation.isOpen} message=\"Are you sure you want to permanently delete this list and all its comments?\" onConfirm={confirmDeleteList} onCancel={() => setDeleteConfirmation({ isOpen: false, listId: null })} />\n            <header className=\"bg-white shadow-sm sticky top-0 z-10\">\n                <div className=\"container mx-auto px-4\">\n                    <div className=\"flex justify-between items-center py-4\">\n                        <div className=\"text-2xl font-bold text-indigo-600 cursor-pointer\" onClick={() => navigateTo('home')}>Votely</div>\n                        <div className=\"hidden md:flex items-center space-x-6\">\n                            {user && !user.isAnonymous ? (\n                                <>\n                                    <button onClick={() => navigateTo('account')} className=\"text-gray-600 text-sm font-semibold hover:text-indigo-600\">{usersMap[user.uid]?.username || user.email}</button>\n                                    <button onClick={handleLogout} className=\"text-gray-600 hover:text-indigo-600\">Logout</button>\n                                </>\n                            ) : (\n                                <>\n                                    <button onClick={() => navigateTo('auth', false)} className=\"text-gray-600 hover:text-indigo-600\">Login</button>\n                                    <button onClick={() => navigateTo('auth', true)} className=\"bg-indigo-500 text-white px-4 py-2 rounded-lg hover:bg-indigo-600 shadow-sm transition-all\">Sign Up</button>\n                                </>\n                            )}\n                        </div>\n                        <div className=\"md:hidden\"><button className=\"text-gray-600 hover:text-gray-900\"><svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M4 6h16M4 12h16m-7 6h7\"></path></svg></button></div>\n                    </div>\n                </div>\n            </header>\n            {renderContent()}\n            <footer className=\"bg-white\">\n                <div className=\"container mx-auto px-4 py-6 text-center text-gray-600\">\n                    &copy; {new Date().getFullYear()} Votely. All rights reserved.\n                </div>\n            </footer>\n        </div>\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}